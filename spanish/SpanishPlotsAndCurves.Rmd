---
title: "English Plots"
author: "Masoud Jasbi"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r packages, include=FALSE}
library(tidyverse)
library(feather)
library(brms)
library(ggeffects)
library(ggrepel)
```

```{r}
knitr::opts_chunk$set(error = TRUE)
```
# Load Data

```{r processedEnglishTokens}
english_tokens_processed <- read_feather("../processed_data/english_tokens_processed.feather")

english_tokens_contract_processed <-
read_feather("../processed_data/english_tokens_contract_processed.feather")
```

# Computing Cumulative Relative Frequencies

## Function vs. Content Words

Here we compute cumulative relative frequencies of function vs. content words by grouping by "syntactic category":

```{r}
syncategory_relfreq <-
  english_tokens_contract_processed %>%
  group_by(syncategory, age, speaker) %>%
  summarise(freq=n()) %>%
  group_by(speaker, age) %>%
  mutate(total=sum(freq), relfreq=freq/sum(freq), pct=relfreq*100) %>%
  group_by(syncategory, speaker) %>%
  arrange(age) %>%
  mutate(cum_freq = cumsum(freq), cum_total= cumsum(total), cumulative_relfreq = cumsum(freq)/cumsum(total), cumulative_pct=cumulative_relfreq*100)

saveRDS(syncategory_relfreq, "syncategory_relfreq.RDS")
```

## Individual Function Words

Here we compute cumulative relative frequencies for individual function words by groupingby "word":

```{r}
functionword_relfreq <-
  english_tokens_contract_processed %>%
  group_by(word, age, speaker) %>%
  summarise(freq=n()) %>%
  group_by(speaker, age) %>%
  mutate(total=sum(freq), relfreq=freq/sum(freq), ppt=relfreq*1000) %>%
  group_by(word, speaker) %>%
  arrange(age) %>%
  mutate(cum_freq = cumsum(freq), cum_total= cumsum(total), cumulative_relfreq = cumsum(freq)/cumsum(total), cumulative_ppt=cumulative_relfreq*1000)

saveRDS(functionword_relfreq, "functionword_relfreq.RDS")
```

## Function Word Semantic Categories

Here we compute cumulative relative frequencies by semantic categories we have created. However, we have not planned any analyses of these yet.

```{r}
wordcategory_relfreq <-
  english_tokens_contract_processed %>%
  group_by(word_category, age, speaker) %>%
  summarise(freq=n()) %>%
  group_by(speaker, age) %>%
  mutate(total=sum(freq), relfreq=freq/sum(freq), ppt=relfreq*1000) %>%
  group_by(word_category, speaker) %>%
  arrange(age) %>%
  mutate(cum_freq = cumsum(freq), cum_total= cumsum(total), cumulative_relfreq = cumsum(freq)/cumsum(total))

saveRDS(wordcategory_relfreq, "wordcategory_relfreq.RDS")
```

## Function Word Syntactic Categories

We have not yet looked at the emergence of different syntactic categories

# Plots and Growth Curves

## Content vs. Function Word Production

The graph below shows percent word category (content vs. function word) in each monthly been during the development of the child for parents and children.

```{r}
syncategory_relfreq %>%
  filter(syncategory=="Function") %>%
  ggplot(aes(age, pct)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() +
  xlab("Age (Months)") + ylab("Percentage") + 
  scale_y_continuous(limits = c(0, 100)) +
  theme(text = element_text(family = "Times New Roman", size = 10))
```

```{r Neg_No_Growth_Model, include=FALSE}
function_words_lagModel <- brm(
  bf(pct  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(syncategory_relfreq, syncategory=="Function", speaker=="child"),
  prior = c(
    prior(uniform(0, 100), nlpar = "upperAsymptote", lb = 0, ub = 100),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/function_word_lagModel",
  iter = 10000)
```

```{r function_word_predictions}
function_words_predictions <- as.data.frame(fitted(function_words_lagModel))

function_words_childdata <- filter(syncategory_relfreq, syncategory=="Function", speaker=="child")
function_words_childdata$predictions <- function_words_predictions[, "Estimate"]

saveRDS(function_words_childdata, "../processed_data/function_words_childdata.RDS")
```

```{r neg_no_prediction_Plot} 
function_words_plot <-
  ggplot(function_words_childdata, aes(x = age, y = pct)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Function Words", x="Child Age (Month)", y="Percent") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```


## Distribution of Individual Function Words

### Definites and Demonstratives

#### The (Done)

```{r the_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="the")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r the_growth_model, include=FALSE}
the_lagModel  <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="the", speaker=="child"),
  prior = c(
    prior(uniform(0, 30), nlpar = "upperAsymptote", lb = 0, ub = 30),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/the_lagModel",
  iter = 10000)
```

```{r the_age_of_production}
age_of_production <-
  rbind(age_of_production, c("the", round(fixef(the_lagModel)[3,],1)))
```

```{r the_predictions}
the_predictions <- as.data.frame(fitted(the_lagModel))

the_childdata <- filter(functionword_relfreq, word=="the", speaker=="child")
the_childdata$predictions <- the_predictions[, "Estimate"]
```

```{r the_prediction_Plot} 
the_plot <-
  ggplot(the_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="The", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### A (Done)

```{r a_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="a")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r a_growth_model, include=FALSE}
a_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="a", speaker=="child"),
  prior = c(
    prior(uniform(0, 40), nlpar = "upperAsymptote", lb = 0, ub = 40),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/a_lagModel",
  iter = 10000)
```

```{r a_age_of_production}
age_of_production <-
  rbind(age_of_production, c("a", round(fixef(a_lagModel)[3,],1)))
```

```{r a_predictions}
a_predictions <- as.data.frame(fitted(a_lagModel))

a_childdata <- filter(functionword_relfreq, word=="a", speaker=="child")
a_childdata$predictions <- a_predictions[, "Estimate"]
```

```{r a_prediction_Plot} 
a_plot <-
  ggplot(a_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="A", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### This (Done)

```{r the_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="this")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r this_growth_model, include=FALSE}
this_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="this", speaker=="child"),
  prior = c(
    prior(uniform(0, 20), nlpar = "upperAsymptote", lb = 0, ub = 20),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/this_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r this_age_of_production}
age_of_production <-
  rbind(age_of_production, c("this", round(fixef(this_lagModel)[3,],1)))
```

```{r this_predictions}
this_predictions <- as.data.frame(fitted(this_lagModel))

this_childdata <- filter(functionword_relfreq, word=="this", speaker=="child")
this_childdata$predictions <- this_predictions[, "Estimate"]
```

```{r this_prediction_Plot} 
this_plot <-
  ggplot(this_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="This", x="Age (Months)", y="") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### That (Done)

"that" can be a determiner or a complementizer and you need to separate them.

```{r a_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="that")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r that_growth_model, include=FALSE}
that_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="that", speaker=="child"),
  prior = c(
    prior(uniform(0, 30), nlpar = "upperAsymptote", lb = 0, ub = 30),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/that_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 10000)
```

```{r that_age_of_production}
age_of_production <-
  rbind(age_of_production, c("that", round(fixef(that_lagModel)[3,],1)))
```

```{r that_predictions}
that_predictions <- as.data.frame(fitted(that_lagModel))

that_childdata <- filter(functionword_relfreq, word=="that", speaker=="child")
that_childdata$predictions <- that_predictions[, "Estimate"]
```

```{r that_prediction_Plot} 
that_plot <-
  ggplot(that_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="That", x="Age (Months)", y="") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### These (Done)

```{r these_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="these")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r these_growth_model, include=FALSE}
these_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="these", speaker=="child"),
  prior = c(
    prior(uniform(0, 3), nlpar = "upperAsymptote", lb = 0, ub = 3),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/these_lagModel",
  iter = 10000)
```

```{r these_age_of_production}
age_of_production <-
  rbind(age_of_production, c("these", round(fixef(these_lagModel)[3,],1)))
```

```{r these_predictions}
these_predictions <- as.data.frame(fitted(these_lagModel))

these_childdata <- filter(functionword_relfreq, word=="these", speaker=="child")
these_childdata$predictions <- these_predictions[, "Estimate"]
```

```{r these_prediction_Plot} 
ggplot(these_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="These", x="Age (Months)", y="") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```


#### Those (Done)

```{r those_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="those")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r those_growth_model, include=FALSE}
those_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="those", speaker=="child"),
  prior = c(
    prior(uniform(0, 2), nlpar = "upperAsymptote", lb = 0, ub = 2),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/those_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r those_age_of_production}
age_of_production <-
  rbind(age_of_production, c("those", round(fixef(those_lagModel)[3,],1)))
```

```{r those_predictions}
those_predictions <- as.data.frame(fitted(those_lagModel))

those_childdata <- filter(functionword_relfreq, word=="those", speaker=="child")
those_childdata$predictions <- those_predictions[, "Estimate"]
```

```{r those_prediction_Plot} 
ggplot(those_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Those", x="Age (Months)", y="") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

### Connectives

#### Negation

##### No (Done)

```{r negation_no}
functionword_relfreq %>%
  filter(word=="no") %>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() + 
  xlab("Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r Neg_No_Growth_Model, include=FALSE}
neg_no_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="no", speaker=="child"),
  prior = c(
    prior(uniform(0, 40), nlpar = "upperAsymptote", lb = 0, ub = 40),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/neg_no_lagModel",
  iter = 10000)
```

```{r age_of_production}
age_of_production<- 
  data.frame(word = c("no"), 
           Estimate = c(round(fixef(neg_no_lagModel)[3,1],1)),
           Est.Error = c(round(fixef(neg_no_lagModel)[3,2],1)),
           Q2.5 = c(round(fixef(neg_no_lagModel)[3,3],1)),
           Q97.5 = c(round(fixef(neg_no_lagModel)[3,4],1))
           )
```

```{r neg_no_predictions}
neg_no_predictions <- as.data.frame(fitted(neg_no_lagModel))

neg_no_childdata <- filter(functionword_relfreq, word=="no", speaker=="child")
neg_no_childdata$predictions <- neg_no_predictions[, "Estimate"]

saveRDS(neg_no_childdata, "../processed_data/neg_no_childdata.RDS")
```

```{r neg_no_prediction_Plot} 
no_plot <-
  ggplot(neg_no_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="No", x="Child Age (Month)", y="Parts per Thousand") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

##### Yes (Done)

```{r negation_no}
functionword_relfreq %>%
  filter(word=="yes") %>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() +
  xlab("Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r yes_Growth_Model, include=FALSE}
yes_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="yes", speaker=="child"),
  prior = c(
    prior(uniform(0, 15), nlpar = "upperAsymptote", lb = 0, ub = 15),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/yes_lagModel",
  iter = 10000)
```

```{r age_of_production_yes}
age_of_production <-
  rbind(age_of_production, c("yes", round(fixef(yes_lagModel)[3,],1)))
```

```{r neg_no_predictions}
yes_predictions <- as.data.frame(fitted(yes_lagModel))

yes_childdata <- filter(functionword_relfreq, word=="yes", speaker=="child")
yes_childdata$predictions <- yes_predictions[, "Estimate"]

saveRDS(yes_childdata, "../processed_data/yes_childdata.RDS")
```

```{r neg_no_prediction_Plot} 
yes_plot <-
  ggplot(yes_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Yes", x="Child Age (Month)", y="Parts per Thousand") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

##### Not (Done)

```{r negation_not_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="not") %>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() +
  xlab("Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r negation_not_growth_model, include=FALSE}
neg_not_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="not", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/neg_not_lagModel",
  iter = 10000)
```

```{r age_of_production_not}
age_of_production <-
  rbind(age_of_production, c("not", round(fixef(neg_not_lagModel)[3,],1)))
```

```{r neg_not_predictions}
neg_not_predictions <- as.data.frame(fitted(neg_not_lagModel))

neg_not_childdata <- filter(functionword_relfreq, word=="not", speaker=="child")
neg_not_childdata$predictions <- neg_not_predictions[, "Estimate"]

saveRDS(neg_not_childdata, "../processed_data/neg_not_childdata.RDS")
```

```{r neg_not_prediction_Plot} 
not_plot <-
  ggplot(neg_not_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Not", x="Child Age (Month)", y="Parts per Thousand") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

##### n't (Done)

```{r negation_not_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="n't") %>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw()
```

```{r negation_nt_growth_model, include=FALSE}
neg_nt_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="n't", speaker=="child"),
  prior = c(
    prior(uniform(0, 15), nlpar = "upperAsymptote", lb = 0, ub = 15),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/neg_nt_lagModel",
  iter = 10000)
```

```{r age_of_production_not}
age_of_production <-
  rbind(age_of_production, c("n't", round(fixef(neg_nt_lagModel)[3,],1)))
```

```{r neg_not_predictions}
neg_nt_predictions <- as.data.frame(fitted(neg_nt_lagModel))

neg_nt_childdata <- filter(functionword_relfreq, word=="n't", speaker=="child")
neg_nt_childdata$predictions <- neg_nt_predictions[, "Estimate"]

saveRDS(neg_nt_childdata, "../processed_data/neg_nt_childdata.RDS")
```

```{r neg_not_prediction_Plot} 
nt_plot <-
  ggplot(neg_not_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="n't", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### And (Done)

```{r conjunction_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="and")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw()
```

```{r conjunction_growth_model, include=FALSE}
and_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="and", speaker=="child"),
  prior = c(
    prior(uniform(0, 25), nlpar = "upperAsymptote", lb = 0, ub = 25),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/and_lagModel",
  iter = 10000)
```

```{r age_of_production_and}
age_of_production <-
  rbind(age_of_production, c("and", round(fixef(and_lagModel)[3,],1)))
```

```{r conjunction_predictions}
and_predictions <- as.data.frame(fitted(and_lagModel))

and_childdata <- filter(functionword_relfreq, word=="and", speaker=="child")
and_childdata$predictions <- and_predictions[, "Estimate"]

saveRDS(and_childdata, "../processed_data/and_childdata.RDS")
```

```{r conjunction_prediction_Plot} 
and_plot <-
  ggplot(and_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="And", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### Or (Done)

There were a total of 10 examples of "or" below the age of 20 months. The majority (5) of them came from the Davis-CDI corpus that were simply the repetition of the phrase "bye or bye bye". The whole corpus seemed to be the CDI word list read by parents rather than children. We suspect there are issues with all these 10 instances so we have excluded them from the growth curve analysis of "or".

```{r conjunction, echo=FALSE}
functionword_relfreq %>%
  filter(word=="or", age>20)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  xlab("Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r}
english_tokens_processed %>%
  filter(word=="or", age<20, speaker=="child")
```

```{r disjunction_growth_model, include=FALSE}
or_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="or", age>20, speaker=="child"),
  prior = c(
    prior(uniform(0, 2), nlpar = "upperAsymptote", lb = 0, ub = 2),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/or_lagModel",
  iter = 10000)
```

```{r age_of_production_or}
age_of_production <-
  rbind(age_of_production, c("or", round(fixef(or_lagModel)[3,],1)))
```

```{r or_predictions}
or_predictions <- as.data.frame(fitted(or_lagModel))

or_childdata <- filter(functionword_relfreq, word=="or", speaker=="child", age>20)
or_childdata$predictions <- or_predictions[, "Estimate"]

saveRDS(or_childdata, "../processed_data/or_childdata.RDS")
```

```{r conjunction_prediction_Plot} 
or_plot <-
  ggplot(or_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Or", x="Child Age (Months)", y="Parts per Thousand") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### If (Done)

```{r conditional, echo=FALSE}
functionword_relfreq %>%
  filter(word=="if")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r disjunction_growth_model, include=FALSE}
if_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="if", speaker=="child"),
  prior = c(
    prior(uniform(0, 2), nlpar = "upperAsymptote", lb = 0, ub = 2),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/if_lagModel",
  iter = 10000)
```

```{r age_of_production_if}
age_of_production <-
  rbind(age_of_production, c("if", round(fixef(if_lagModel)[3,],1)))
```

```{r conjunction_predictions}
if_predictions <- as.data.frame(fitted(if_lagModel))

if_childdata <- filter(functionword_relfreq, word=="if", speaker=="child")
if_childdata$predictions <- if_predictions[, "Estimate"]

saveRDS(if_childdata, "../processed_data/if_childdata.RDS")
```

```{r conjunction_prediction_Plot} 
if_plot <-
  ggplot(if_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="IF", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### But (Done)

```{r but_connective_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="but")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r but_growth_model, include=FALSE}
but_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="but", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/but_lagModel",
  iter = 10000)
```

```{r age_of_production_if}
age_of_production <-
  rbind(age_of_production, c("but", round(fixef(but_lagModel)[3,],1)))
```

```{r but_predictions}
but_predictions <- as.data.frame(fitted(but_lagModel))

but_childdata <- filter(functionword_relfreq, word=="but", speaker=="child")
but_childdata$predictions <- but_predictions[, "Estimate"]

saveRDS(but_childdata, "../processed_data/but_childdata.RDS")
```

```{r but_prediction_Plot} 
but_plot <-
  ggplot(but_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="BUT", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### Because (Done)

```{r because_other_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="because")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r because_growth_model, include=FALSE}
because_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="because", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/because_lagModel",
  iter = 10000)
```

```{r because_age_of_production}
age_of_production <-
  rbind(age_of_production, c("because", round(fixef(because_lagModel)[3,],1)))
```

```{r because_predictions}
because_predictions <- as.data.frame(fitted(because_lagModel))

because_childdata <- filter(functionword_relfreq, word=="because", speaker=="child")
because_childdata$predictions <- because_predictions[, "Estimate"]

saveRDS(because_childdata, "../processed_data/because_childdata.RDS")
```

```{r because_prediction_Plot} 
because_plot<-
  ggplot(because_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Because", x="Age (Months)", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```


#### Unless (Divergent Transitions)
```{r unless_connective_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="unless")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()+
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r unless_growth_model, include=FALSE}
unless_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="unless", speaker=="child"),
  prior = c(
    prior(uniform(0, 0.03), nlpar = "upperAsymptote", lb = 0, ub = 0.03),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/unless_lagModel",
  iter = 20000)
```

```{r age_of_production_if}
age_of_production <-
  rbind(age_of_production, c("unless", round(fixef(unless_lagModel)[3,],1)))
```

```{r unless_predictions}
unless_predictions <- as.data.frame(fitted(unless_lagModel))

unless_childdata <- filter(functionword_relfreq, word=="unless", speaker=="child")
unless_childdata$predictions <- unless_predictions[, "Estimate"]

saveRDS(unless_childdata, "../processed_data/unless_childdata.RDS")
```

```{r unless_prediction_Plot} 
unless_plot <-
  ggplot(unless_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="BECAUSE", x="Age (Months)", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```


#### Although (Not enough data)

```{r usually_temporalQuant_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="although")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() +
  xlab("Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

### Wh Words

#### What (Done)

```{r what_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="what")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r what_growth_model, include=FALSE}
what_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="what", speaker=="child"),
  prior = c(
    prior(uniform(0, 20), nlpar = "upperAsymptote", lb = 0, ub = 20),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/what_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r what_age_of_production}
age_of_production <-
  rbind(age_of_production, c("what", round(fixef(what_lagModel)[3,],1)))
```

```{r what_predictions}
what_predictions <- as.data.frame(fitted(what_lagModel))

what_childdata <- filter(functionword_relfreq, word=="what", speaker=="child")
what_childdata$predictions <- what_predictions[, "Estimate"]
```

```{r what_prediction_Plot} 
what_plot <-
  ggplot(what_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="What", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```


#### Who (Done)

```{r can_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="who")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r who_growth_model, include=FALSE}
who_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="who", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/who_lagModel",
  iter = 10000)
```

```{r who_age_of_production}
age_of_production <-
  rbind(age_of_production, c("who", round(fixef(who_lagModel)[3,],1)))
```

```{r who_predictions}
who_predictions <- as.data.frame(fitted(who_lagModel))

who_childdata <- filter(functionword_relfreq, word=="who", speaker=="child")
who_childdata$predictions <- who_predictions[, "Estimate"]
```

```{r who_prediction_Plot} 
who_plot <-
  ggplot(who_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Who", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### When (Done)

```{r when_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="when")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()  + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r when_growth_model, include=FALSE}
when_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="when", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/when_lagModel",
  iter = 10000)
```

```{r when_age_of_production}
age_of_production <-
  rbind(age_of_production, c("when", round(fixef(when_lagModel)[3,],1)))
```

```{r when_predictions}
when_predictions <- as.data.frame(fitted(when_lagModel))

when_childdata <- filter(functionword_relfreq, word=="when", speaker=="child")
when_childdata$predictions <- when_predictions[, "Estimate"]
```

```{r who_prediction_Plot} 
When_plot <-
  ggplot(when_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="When", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### Where (Done)

```{r when_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="where")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r where_growth_model, include=FALSE}
where_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="where", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/where_lagModel",
  iter = 10000)
```

```{r where_age_of_production}
age_of_production <-
  rbind(age_of_production, c("where", round(fixef(where_lagModel)[3,],1)))
```

```{r where_predictions}
where_predictions <- as.data.frame(fitted(where_lagModel))

where_childdata <- filter(functionword_relfreq, word=="where", speaker=="child")
where_childdata$predictions <- where_predictions[, "Estimate"]
```

```{r where_prediction_Plot} 
Where_plot <-
  ggplot(where_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Where", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### Why (Done)

```{r why_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="why")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r why_growth_model, include=FALSE}
why_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="why", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/why_lagModel",
  iter = 10000)
```

```{r why_predictions}
why_predictions <- as.data.frame(fitted(why_lagModel))

why_childdata <- filter(functionword_relfreq, word=="why", speaker=="child")
why_childdata$predictions <- why_predictions[, "Estimate"]
```

```{r why_prediction_Plot} 
why_plot <-
  ggplot(why_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Why", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r why_age_of_production}
age_of_production <-
  rbind(age_of_production, c("why", round(fixef(why_lagModel)[3,],1)))
```

#### How (Unreliable)

```{r how_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="how")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r how_growth_model, include=FALSE}
how_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="how", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/how_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r how_predictions}
how_predictions <- as.data.frame(fitted(how_lagModel))

how_childdata <- filter(functionword_relfreq, word=="how", speaker=="child")
how_childdata$predictions <- how_predictions[, "Estimate"]
```

```{r how_prediction_Plot} 
how_plot <-
  ggplot(how_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="How", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r how_age_of_production}
age_of_production <-
  rbind(age_of_production, c("how", round(fixef(how_lagModel)[3,],1)))
```

#### Whose (Unreliable)

```{r whose_Wh_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="whose")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r whose_wh_model, include=FALSE}
whose_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="whose", speaker=="child", age>20),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/whose_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 10000)
```

```{r how_age_of_production}
age_of_production <-
  rbind(age_of_production, c("how", round(fixef(how_lagModel)[3,],1)))
```

```{r how_predictions}
how_predictions <- as.data.frame(fitted(how_lagModel))

how_childdata <- filter(functionword_relfreq, word=="how", speaker=="child")
how_childdata$predictions <- how_predictions[, "Estimate"]
```

```{r how_prediction_Plot} 
ggplot(how_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```



### Modals

may, ought, perhaps, shall (missing because they are too formal)

will, would (missing because they have contracted forms)

#### Can (Done)

Not enough "cannot" to be worth investigating

```{r can_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="can")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Can") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r modal_can_growth_model, include=FALSE}
can_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="can", speaker=="child"),
  prior = c(
    prior(uniform(0, 20), nlpar = "upperAsymptote", lb = 0, ub = 20),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/can_lagModel",
  iter = 10000)
```

```{r can_predictions}
can_predictions <- as.data.frame(fitted(can_lagModel))

can_childdata <- filter(functionword_relfreq, word=="can", speaker=="child")
can_childdata$predictions <- can_predictions[, "Estimate"]
```

```{r can_prediction_Plot} 
can_plot <-
  ggplot(can_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Can", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r can_age_of_production}
age_of_production <-
  rbind(age_of_production, c("can", round(fixef(can_lagModel)[3,],1)))
```


#### Could (Done)

```{r could_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="could")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +   labs(title = "Could") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r could_growth_model, include=FALSE}
could_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="could", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/could_lagModel",
  iter = 10000)
```

```{r could_predictions}
could_predictions <- as.data.frame(fitted(could_lagModel))

could_childdata <- filter(functionword_relfreq, word=="could", speaker=="child")
could_childdata$predictions <- could_predictions[, "Estimate"]
```

```{r many_prediction_Plot} 
could_plot <-
  ggplot(could_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Could", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r could_age_of_production}
age_of_production <-
  rbind(age_of_production, c("could", round(fixef(could_lagModel)[3,],1)))
```

#### Need (Done)

```{r need_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="need")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() + labs(title = "Need") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r need_growth_model, include=FALSE}
need_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="need", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/need_lagModel",
  iter = 10000)
```

```{r need_predictions}
need_predictions <- as.data.frame(fitted(need_lagModel))

need_childdata <- filter(functionword_relfreq, word=="need", speaker=="child")
need_childdata$predictions <- need_predictions[, "Estimate"]
```

```{r need_prediction_Plot} 
need_plot <-
  ggplot(need_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Need", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r need_age_of_production}
age_of_production <-
  rbind(age_of_production, c("need", round(fixef(need_lagModel)[3,],1)))
```

#### Maybe

```{r need_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="maybe")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Maybe") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r maybe_growth_model, include=FALSE}
maybe_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="maybe", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/maybe_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 10000)
```

```{r maybe_predictions}
maybe_predictions <- as.data.frame(fitted(maybe_lagModel))

maybe_childdata <- filter(functionword_relfreq, word=="maybe", speaker=="child")
maybe_childdata$predictions <- maybe_predictions[, "Estimate"]
```

```{r maybe_prediction_Plot} 
maybe_plot <-
  ggplot(maybe_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Maybe", x="Age (Months)", y="Cumulative Relative Frequency (PPT)") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r maybe_age_of_production}
age_of_production <-
  rbind(age_of_production, c("maybe", round(fixef(maybe_lagModel)[3,],1)))
```

#### Might (Unreliable)

```{r might_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="might")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() +
  labs(title = "Might") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r might_growth_model, include=FALSE}
might_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="might", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/might_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 10000)
```

```{r might_predictions}
might_predictions <- as.data.frame(fitted(might_lagModel))

might_childdata <- filter(functionword_relfreq, word=="might", speaker=="child")
might_childdata$predictions <- might_predictions[, "Estimate"]
```

```{r might_prediction_Plot} 
might_plot <-
  ggplot(might_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Might", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r might_age_of_production}
age_of_production <-
  rbind(age_of_production, c("might", round(fixef(might_lagModel)[3,],1)))
```


#### Must (Unreliable)

```{r must_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="must") %>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() +
  labs(title = "Must") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r must_growth_model, include=FALSE}
must_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="must", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/must_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r must_predictions}
must_predictions <- as.data.frame(fitted(must_lagModel))

must_childdata <- filter(functionword_relfreq, word=="must", speaker=="child")
must_childdata$predictions <- must_predictions[, "Estimate"]
```

```{r must_prediction_Plot} 
must_plot <-
  ggplot(must_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Must", x="Age (Months)", y="Cumulative Relative Frequency (PPT)") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r must_age_of_production}
age_of_production <-
  rbind(age_of_production, c("must", round(fixef(must_lagModel)[3,],1)))
```



#### Should (Unreliable)

```{r should_modal_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="should", age>15) %>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() +
  labs(title = "Should") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r should_growth_model, include=FALSE}
should_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="should", speaker=="child", age>12),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/should_lagModel",
  control = list(adapt_delta = 0.98),
  iter = 10000)
```

```{r should_predictions}
should_predictions <- as.data.frame(fitted(should_lagModel))

should_childdata <- filter(functionword_relfreq, word=="should", speaker=="child", age>12)
should_childdata$predictions <- should_predictions[, "Estimate"]
```

```{r should_prediction_Plot} 
should_plot <-
  ggplot(should_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()+ labs(title="Should", x="Age (Months)", y="Cumulative Relative Frequency (PPT)") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r should_age_of_production}
age_of_production <-
  rbind(age_of_production, c("should", round(fixef(should_lagModel)[3,],1)))
```

### Individual Quantifiers

#### All (Done)

```{r all_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="all")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r all_growth_model, include=FALSE}
all_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="all", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/all_lagModel",
  iter = 10000)
```

```{r age_of_production_all}
age_of_production <-
  rbind(age_of_production, c("all", round(fixef(all_lagModel)[3,],1)))
```

```{r all_predictions}
all_predictions <- as.data.frame(fitted(all_lagModel))

all_childdata <- filter(functionword_relfreq, word=="all", speaker=="child")
all_childdata$predictions <- all_predictions[, "Estimate"]

saveRDS(all_childdata, "../processed_data/all_childdata.RDS")
```

```{r all_prediction_Plot} 
all_plot<-
  ggplot(all_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="All", x="Age (Months)", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### Some (Done)

```{r some_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="some")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r some_growth_model, include=FALSE}
some_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="some", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/some_lagModel",
  iter = 10000)
```

```{r some_age_of_production}
age_of_production <-
  rbind(age_of_production, c("some", round(fixef(some_lagModel)[3,],1)))
```

```{r some_predictions}
some_predictions <- as.data.frame(fitted(some_lagModel))

some_childdata <- filter(functionword_relfreq, word=="some", speaker=="child")
some_childdata$predictions <- some_predictions[, "Estimate"]

saveRDS(some_childdata, "../processed_data/some_childdata.RDS")
```

```{r some_prediction_Plot} 
some_plot <- 
  ggplot(some_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Some", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### Both (Divergent Transition) 

```{r both_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="both")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r both_growth_model, include=FALSE}
both_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="both", speaker=="child"),
  prior = c(
    prior(uniform(0, 0.5), nlpar = "upperAsymptote", lb = 0, ub = 0.5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/both_lagModel",
  control = list(adapt_delta = 0.99),
  iter = 20000)
```

```{r both_age_of_production}
age_of_production <-
  rbind(age_of_production, c("both", round(fixef(both_lagModel)[3,],1)))
```

```{r both_predictions}
both_predictions <- as.data.frame(fitted(both_lagModel))

both_childdata <- filter(functionword_relfreq, word=="both", speaker=="child")
both_childdata$predictions <- both_predictions[, "Estimate"]

saveRDS(both_childdata, "../processed_data/both_childdata.RDS")
```

```{r both_prediction_Plot} 
both_plot <-
  ggplot(both_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Both", x="Child Age (Months)", y="Parts per Thousand") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### Each (Unreliable)

```{r each_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="each")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r each_growth_model, include=FALSE}
each_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="each", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/each_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r each_age_of_production}
age_of_production <-
  rbind(age_of_production, c("each", round(fixef(each_lagModel)[3,],1)))
```

```{r each_predictions}
each_predictions <- as.data.frame(fitted(each_lagModel))

each_childdata <- filter(functionword_relfreq, word=="each", speaker=="child")
each_childdata$predictions <- each_predictions[, "Estimate"]

saveRDS(each_childdata, "../processed_data/each_childdata.RDS")
```

```{r each_prediction_Plot} 
each_plot <-
  ggplot(each_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Each", x="Child Age (Months)", y="Parts per Thousand") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### Most (Divergent Transitions)

```{r most_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="most", age>20)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r most_growth_model, include=FALSE}
most_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="most", speaker=="child", age>20),
  prior = c(
    prior(uniform(0, 0.5), nlpar = "upperAsymptote", lb = 0, ub = 0.5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub =10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/most_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 20000)
```

```{r age_of_production_all}
age_of_production <-
  rbind(age_of_production, c("most", round(fixef(most_lagModel)[3,],1)))
```

```{r most_predictions}
most_predictions <- as.data.frame(fitted(most_lagModel))

most_childdata <- filter(functionword_relfreq, word=="most", speaker=="child", age>20)
most_childdata$predictions <- most_predictions[, "Estimate"]

saveRDS(most_childdata, "../processed_data/most_childdata.RDS")
```

```{r most_prediction_Plot} 
most_plot <-
  ggplot(most_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Most", x="Child Age (Months)", y="Parts per Thousand") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### Every (Not Converging)

```{r every_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="every")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r every_growth_model, include=FALSE}
every_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="every", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/every_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 50000)
```

```{r every_age_of_production}
age_of_production <-
  rbind(age_of_production, c("every", round(fixef(every_lagModel)[3,],1)))
```

```{r every_predictions}
every_predictions <- as.data.frame(fitted(every_lagModel))

every_childdata <- filter(functionword_relfreq, word=="every", speaker=="child")
every_childdata$predictions <- every_predictions[, "Estimate"]

saveRDS(every_childdata, "../processed_data/every_childdata.RDS")
```

```{r every_prediction_Plot} 
every_plot <-
  ggplot(every_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Every", x="Child Age (Months)", y="Parts per Thousand") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### Many (Not Converging)

```{r many_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="many")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  xlab("Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r many_growth_model, include=FALSE}
many_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="many", age>20, speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/many_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 12000)
```

```{r many_age_of_production}
age_of_production <-
  rbind(age_of_production, c("many", round(fixef(many_lagModel)[3,],1)))
```

```{r many_predictions}
many_predictions <- as.data.frame(fitted(many_lagModel))

many_childdata <- filter(functionword_relfreq, word=="many", speaker=="child")
many_childdata$predictions <- many_predictions[, "Estimate"]

saveRDS(many_childdata, "../processed_data/many_childdata.RDS")
```

```{r many_prediction_Plot} 
ggplot(many_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### None

```{r none_quantifier_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="none")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) +
  theme_bw() +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r none_growth_model, include=FALSE}
none_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="none", speaker=="child"),
  prior = c(
    prior(uniform(0, 0.5), nlpar = "upperAsymptote", lb = 0, ub = 0.5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/none_lagModel",
  iter = 15000)
```

```{r age_of_production_all}
age_of_production <-
  rbind(age_of_production, c("none", round(fixef(none_lagModel)[3,],1)))
```

```{r none_predictions}
none_predictions <- as.data.frame(fitted(none_lagModel))

none_childdata <- filter(functionword_relfreq, word=="none", speaker=="child")
none_childdata$predictions <- none_predictions[, "Estimate"]

saveRDS(none_childdata, "../processed_data/none_childdata.RDS")
```

```{r none_prediction_Plot} 
none_plot <-
  ggplot(none_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Every", x="Child Age (Months)", y="Parts per Thousand") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### Few

```{r few_quantifier_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="few")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```


#### Everyone

```{r everyone_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="everyone")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```




#### Everybody

```{r everyone_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="everybody")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

#### Everything

```{r everything_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="everything")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

#### Someone

```{r someone_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="someone", age>20)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

#### Somebody

```{r somebody_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="somebody", age>20)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```


#### Something

```{r something_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="something")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

#### Everywhere
#### Somewhere

```{r everywhere_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="everywhere")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

#### Somewhere

```{r something_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="somewhere")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

### Temporal Quantifiers

#### Always (Done)

```{r always_temporalQuant_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="always")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

```{r always_growth_model, include=FALSE}
always_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="always", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/always_lagModel",
  iter = 10000)
```

```{r always_predictions}
always_predictions <- as.data.frame(fitted(always_lagModel))

always_childdata <- filter(functionword_relfreq, word=="always", speaker=="child")
always_childdata$predictions <- always_predictions[, "Estimate"]
```

```{r always_prediction_Plot} 
always_plot<-
  ggplot(always_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="always", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r age_of_production_all}
age_of_production <-
  rbind(age_of_production, c("always", round(fixef(always_lagModel)[3,],1)))
```


#### Sometimes (Done)

```{r sometimes_temporalQuant_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="sometimes")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r sometimes_growth_model, include=FALSE}
sometimes_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="sometimes", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/sometimes_lagModel",
  iter = 10000)
```

```{r age_of_production_all}
age_of_production <-
  rbind(age_of_production, c("sometimes", round(fixef(sometimes_lagModel)[3,],1)))
```

```{r all_predictions}
sometimes_predictions <- as.data.frame(fitted(sometimes_lagModel))

sometimes_childdata <- filter(functionword_relfreq, word=="sometimes", speaker=="child")
sometimes_childdata$predictions <- sometimes_predictions[, "Estimate"]
```

```{r all_prediction_Plot} 
sometimes_plot<-
  ggplot(sometimes_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="SOMETIMES", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### Usually (Not Converging)

```{r usually_temporalQuant_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="usually")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r usually_growth_model, include=FALSE}
usually_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="usually", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/usually_lagModel",
  iter = 10000)
```

```{r ususally_age_of_production}
age_of_production <-
  rbind(age_of_production, c("usually", round(fixef(usually_lagModel)[3,],1)))
```

```{r ususally_predictions}
usually_predictions <- as.data.frame(fitted(usually_lagModel))

usually_childdata <- filter(functionword_relfreq, word=="usually", speaker=="child")
usually_childdata$predictions <- usually_predictions[, "Estimate"]
```

```{r ususally_prediction_Plot} 
ggplot(usually_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### Never (Not Convergin, unreliable)

```{r never_temporalQuant_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="never", age>12)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r never_growth_model, include=FALSE}
never_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="never", speaker=="child", age>12),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/never_lagModel",
  control = list(adapt_delta = 0.99),
  iter = 10000)
```

```{r never_of_production_all}
age_of_production <-
  rbind(age_of_production, c("never", round(fixef(never_lagModel)[3,],1)))
```

```{r never_predictions}
never_predictions <- as.data.frame(fitted(never_lagModel))

never_childdata <- filter(functionword_relfreq, word=="never", speaker=="child", age>12)
never_childdata$predictions <- never_predictions[, "Estimate"]
```

```{r never_prediction_Plot} 
ggplot(never_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

#### Often (Not enough data)

```{r often_temporalQuant_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="often")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker)
```

#### Seldom (No Data!)

```{r seldom_temporalQuant_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="seldom")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker)
```

#### Once (Done)

```{r once_temporalQuant_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="once")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r once_growth_model, include=FALSE}
once_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="once", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb =0, ub = 72)
  ),
  file = "../modeling/once_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r age_of_production_all}
age_of_production <-
  rbind(age_of_production, c("once", round(fixef(once_lagModel)[3,],1)))
```

```{r once_predictions}
once_predictions <- as.data.frame(fitted(once_lagModel))

once_childdata <- filter(functionword_relfreq, word=="once", speaker=="child")
once_childdata$predictions <- once_predictions[, "Estimate"]
```

```{r once_prediction_Plot} 
ggplot(once_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### Twice (Not enough data)

```{r twice_temporalQuant_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="twice")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker)
```


### Temporals

#### Before (Done)

```{r before_temporals_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="before")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "Before")
```

```{r before_growth_model, include=FALSE}
before_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="before", speaker=="child", age>20),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/before_lagModel",
  iter = 10000)
```

```{r age_of_production_all}
age_of_production <-
  rbind(age_of_production, c("before", round(fixef(before_lagModel)[3,],1)))
```

```{r before_predictions}
before_predictions <- as.data.frame(fitted(before_lagModel))

before_childdata <- filter(functionword_relfreq, word=="before", speaker=="child", age>20)
before_childdata$predictions <- before_predictions[, "Estimate"]
```

```{r before_prediction_Plot} 
ggplot(before_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() +
  labs(title = "Before")
```

#### After (Done)

```{r after_temporals_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="after")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "After")
```

```{r after_growth_model, include=FALSE}
after_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="after", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/after_lagModel",
  iter = 12000)
```

```{r age_of_production_all}
age_of_production <-
  rbind(age_of_production, c("after", round(fixef(after_lagModel)[3,],1)))
```

```{r after_predictions}
after_predictions <- as.data.frame(fitted(after_lagModel))

after_childdata <- filter(functionword_relfreq, word=="after", speaker=="child")
after_childdata$predictions <- after_predictions[, "Estimate"]
```

```{r after_prediction_Plot} 
after_plot <-
  ggplot(after_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="AFTER", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```


#### Then

```{r until_temporals_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="then")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r then_growth_model, include=FALSE}
then_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="then", speaker=="child", age>18),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/then_lagModel",
  iter = 10000)
```

```{r age_of_production_all}
age_of_production <-
  rbind(age_of_production, c("then", round(fixef(then_lagModel)[3,],1)))
```

```{r then_predictions}
then_predictions <- as.data.frame(fitted(then_lagModel))

then_childdata <- filter(functionword_relfreq, word=="then", speaker=="child", age>18)
then_childdata$predictions <- then_predictions[, "Estimate"]
```

```{r then_prediction_Plot} 
ggplot(then_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="THEN", x="Age (Months)", y="") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### Until (Done)

```{r until_temporals_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="until", age>21)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r until_growth_model, include=FALSE}
until_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="until", speaker=="child", age>21),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/until_lagModel",
  iter = 10000)
```

```{r age_of_production_all}
age_of_production <-
  rbind(age_of_production, c("until", round(fixef(until_lagModel)[3,],1)))
```

```{r until_predictions}
until_predictions <- as.data.frame(fitted(until_lagModel))

until_childdata <- filter(functionword_relfreq, word=="until", speaker=="child", age>21)
until_childdata$predictions <- until_predictions[, "Estimate"]
```

```{r until_prediction_Plot} 
ggplot(until_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

#### During (Not enough data)

```{r until_temporals_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="during")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker)
```


#### While 

```{r while_temporals_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="while")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r while_growth_model, include=FALSE}
while_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="while", speaker=="child", age>24),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/while_lagModel",
  iter = 12000)
```

```{r age_of_production_all}
age_of_production <-
  rbind(age_of_production, c("while", round(fixef(while_lagModel)[3,],1)))
```

```{r all_predictions}
while_predictions <- as.data.frame(fitted(while_lagModel))

while_childdata <- filter(functionword_relfreq, word=="while", speaker=="child")
while_childdata$predictions <- while_predictions[, "Estimate"]
```

```{r all_prediction_Plot} 
ggplot(while_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

#### Since

```{r since_temporals_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="since")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```




### Comparatives

#### More (Done)

```{r more_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="more")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r more_growth_model, include=FALSE}
more_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="more", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/more_lagModel",
  iter = 20000)
```

```{r many_age_of_production}
age_of_production <-
  rbind(age_of_production, c("more", round(fixef(more_lagModel)[3,],1)))
```

```{r many_predictions}
more_predictions <- as.data.frame(fitted(more_lagModel))

more_childdata <- filter(functionword_relfreq, word=="more", speaker=="child")
more_childdata$predictions <- more_predictions[, "Estimate"]
```

```{r many_prediction_Plot} 
more_plot <-
  ggplot(more_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="More", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```


#### Less (Not enough data)

```{r less_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="less")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

```{r less_growth_model, include=FALSE}
less_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="less", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/less_lagModel",
  iter = 12000)
```

```{r less_age_of_production}
age_of_production <-
  rbind(age_of_production, c("less", round(fixef(many_lagModel)[3,],1)))
```

```{r less_predictions}
less_predictions <- as.data.frame(fitted(less_lagModel))

less_childdata <- filter(functionword_relfreq, word=="less", speaker=="child")
less_childdata$predictions <- less_predictions[, "Estimate"]
```

```{r many_prediction_Plot} 
ggplot(many_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### Much (Unreliable)

```{r much_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="much")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r much_growth_model, include=FALSE}
much_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="much", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/much_lagModel",
  control = list(adapt_delta = 0.98),
  iter = 30000)
```

```{r much_age_of_production}
age_of_production <-
  rbind(age_of_production, c("much", round(fixef(much_lagModel)[3,],1)))
```

```{r much_predictions}
much_predictions <- as.data.frame(fitted(much_lagModel))

much_childdata <- filter(functionword_relfreq, word=="much", speaker=="child")
much_childdata$predictions <- much_predictions[, "Estimate"]
```

```{r much_prediction_Plot} 
ggplot(much_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Much", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```



### Number Words

#### One (Done)

```{r one_numberwords_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="one")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r one_growth_model, include=FALSE}
one_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="one", speaker=="child"),
  prior = c(
    prior(uniform(0, 12), nlpar = "upperAsymptote", lb = 0, ub = 12),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/one_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r anything_age_of_production}
age_of_production <-
  rbind(age_of_production, c("one", round(fixef(one_lagModel)[3,],1)))
```

```{r anything_predictions}
one_predictions <- as.data.frame(fitted(one_lagModel))

one_childdata <- filter(functionword_relfreq, word=="one", speaker=="child")
one_childdata$predictions <- one_predictions[, "Estimate"]
```

```{r anything_prediction_Plot} 
ggplot(one_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

#### Two (Done)

```{r two_numberwords_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="two")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r two_growth_model, include=FALSE}
two_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="two", speaker=="child"),
  prior = c(
    prior(uniform(0, 12), nlpar = "upperAsymptote", lb = 0, ub = 12),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/two_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r two_age_of_production}
age_of_production <-
  rbind(age_of_production, c("two", round(fixef(two_lagModel)[3,],1)))
```

```{r two_predictions}
two_predictions <- as.data.frame(fitted(two_lagModel))

two_childdata <- filter(functionword_relfreq, word=="two", speaker=="child")
two_childdata$predictions <- two_predictions[, "Estimate"]
```

```{r two_prediction_Plot} 
ggplot(two_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### Three (Done)

```{r three_numberwords_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="three")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r three_growth_model, include=FALSE}
three_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="three", speaker=="child"),
  prior = c(
    prior(uniform(0, 3), nlpar = "upperAsymptote", lb = 0, ub = 3),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/three_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 20000)
```

```{r three_age_of_production}
age_of_production <-
  rbind(age_of_production, c("three", round(fixef(three_lagModel)[3,],1)))
```

```{r three_predictions}
three_predictions <- as.data.frame(fitted(three_lagModel))

three_childdata <- filter(functionword_relfreq, word=="three", speaker=="child")
three_childdata$predictions <- three_predictions[, "Estimate"]
```

```{r three_prediction_Plot} 
ggplot(three_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

#### Four (Done)

```{r four_numberwords_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="four")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r four_growth_model, include=FALSE}
four_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="four", speaker=="child"),
  prior = c(
    prior(uniform(0, 2), nlpar = "upperAsymptote", lb = 0, ub = 2),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/four_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r four_age_of_production}
age_of_production <-
  rbind(age_of_production, c("four", round(fixef(four_lagModel)[3,],1)))
```

```{r four_predictions}
four_predictions <- as.data.frame(fitted(four_lagModel))

four_childdata <- filter(functionword_relfreq, word=="four", speaker=="child")
four_childdata$predictions <- four_predictions[, "Estimate"]
```

```{r four_prediction_Plot} 
ggplot(four_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

#### Five (Done)

```{r five_numberwords_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="five")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r five_growth_model, include=FALSE}
five_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="five", speaker=="child"),
  prior = c(
    prior(uniform(0, 2), nlpar = "upperAsymptote", lb = 0, ub = 2),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/five_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r five_age_of_production}
age_of_production <-
  rbind(age_of_production, c("five", round(fixef(five_lagModel)[3,],1)))
```

```{r five_predictions}
five_predictions <- as.data.frame(fitted(five_lagModel))

five_childdata <- filter(functionword_relfreq, word=="five", speaker=="child")
five_childdata$predictions <- five_predictions[, "Estimate"]
```

```{r five_prediction_Plot} 
ggplot(five_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

#### Six (Done)

```{r six_numberwords_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="six")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r six_growth_model, include=FALSE}
six_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="six", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/six_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r six_age_of_production}
age_of_production <-
  rbind(age_of_production, c("six", round(fixef(six_lagModel)[3,],1)))
```

```{r six_predictions}
six_predictions <- as.data.frame(fitted(six_lagModel))

six_childdata <- filter(functionword_relfreq, word=="six", speaker=="child")
six_childdata$predictions <- six_predictions[, "Estimate"]
```

```{r six_prediction_Plot} 
ggplot(six_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

#### Seven (Done)

```{r seven_numberwords_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="seven", age>10)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r seven_growth_model, include=FALSE}
seven_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="seven", speaker=="child", age>12),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/seven_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r seven_age_of_production}
age_of_production <-
  rbind(age_of_production, c("seven", round(fixef(seven_lagModel)[3,],1)))
```

```{r seven_predictions}
seven_predictions <- as.data.frame(fitted(seven_lagModel))

seven_childdata <- filter(functionword_relfreq, word=="seven", speaker=="child", age>12)
seven_childdata$predictions <- seven_predictions[, "Estimate"]
```

```{r seven_prediction_Plot} 
ggplot(seven_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

#### Eight (Done)

```{r eight_numberwords_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="eight")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r eight_growth_model, include=FALSE}
eight_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="eight", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/eight_lagModel",
  control = list(adapt_delta = 0.98),
  iter = 50000)
```

```{r eight_age_of_production}
age_of_production <-
  rbind(age_of_production, c("eight", round(fixef(eight_lagModel)[3,],1)))
```

```{r eight_predictions}
eight_predictions <- as.data.frame(fitted(eight_lagModel))

eight_childdata <- filter(functionword_relfreq, word=="eight", speaker=="child")
eight_childdata$predictions <- eight_predictions[, "Estimate"]
```

```{r eight_prediction_Plot} 
ggplot(eight_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

#### Nine (Done)

```{r nine_numberwords_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="nine")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r nine_growth_model, include=FALSE}
nine_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="nine", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/nine_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 30000)
```

```{r nine_age_of_production}
age_of_production <-
  rbind(age_of_production, c("nine", round(fixef(nine_lagModel)[3,],1)))
```

```{r nine_predictions}
nine_predictions <- as.data.frame(fitted(nine_lagModel))

nine_childdata <- filter(functionword_relfreq, word=="nine", speaker=="child")
nine_childdata$predictions <- nine_predictions[, "Estimate"]
```

```{r nine_prediction_Plot} 
ggplot(nine_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

#### Ten (Not Converging)

```{r ten_numberwords_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="ten")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r ten_growth_model, include=FALSE}
ten_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="ten", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/ten_lagModel",
  control = list(adapt_delta = 0.98),
  iter = 50000)
```

```{r ten_age_of_production}
age_of_production <-
  rbind(age_of_production, c("ten", round(fixef(ten_lagModel)[3,],1)))
```

```{r six_predictions}
ten_predictions <- as.data.frame(fitted(ten_lagModel))

ten_childdata <- filter(functionword_relfreq, word=="ten", speaker=="child")
ten_childdata$predictions <- ten_predictions[, "Estimate"]
```

```{r ten_prediction_Plot} 
ggplot(ten_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

### Ordinals

#### First (Done)

```{r first_ordinals_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="first")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r first_ordinals_growth_model, include=FALSE}
first_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="first", speaker=="child", age>12),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/first_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 12000)
```

```{r first_ordinals_production}
age_of_production <-
  rbind(age_of_production, c("first", round(fixef(first_lagModel)[3,],1)))
```

```{r first_ordinals_predictions}
first_predictions <- as.data.frame(fitted(first_lagModel))

first_childdata <- filter(functionword_relfreq, word=="first", speaker=="child", age>12)
first_childdata$predictions <- first_predictions[, "Estimate"]
```

```{r first_ordinals_prediction_Plot} 
ggplot(first_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### Last (Done)

```{r last_ordinals_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="last")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r last_ordinals_growth_model, include=FALSE}
last_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="last", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/last_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 12000)
```

```{r last_ordinals_production}
age_of_production <-
  rbind(age_of_production, c("last", round(fixef(last_lagModel)[3,],1)))
```

```{r last_ordinals_predictions}
last_predictions <- as.data.frame(fitted(last_lagModel))

last_childdata <- filter(functionword_relfreq, word=="last", speaker=="child")
last_childdata$predictions <- last_predictions[, "Estimate"]
```

```{r last_ordinals_prediction_Plot} 
ggplot(last_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### Second (Not Converging)

```{r second_ordinals_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="second", age>22)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r second_ordinals_growth_model, include=FALSE}
second_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="second", speaker=="child", age>22),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/second_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 12000)
```

```{r second_ordinals_production}
age_of_production <-
  rbind(age_of_production, c("second", round(fixef(second_lagModel)[3,],1)))
```

```{r second_ordinals_predictions}
second_predictions <- as.data.frame(fitted(second_lagModel))

second_childdata <- filter(functionword_relfreq, word=="second", speaker=="child", age>12)
second_childdata$predictions <- second_predictions[, "Estimate"]
```

```{r second_ordinals_prediction_Plot} 
ggplot(second_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### Third

```{r third_ordinals_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="third")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r first_ordinals_growth_model, include=FALSE}
first_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="first", speaker=="child", age>12),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/first_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 12000)
```

```{r first_ordinals_production}
age_of_production <-
  rbind(age_of_production, c("first", round(fixef(first_lagModel)[3,],1)))
```

```{r first_ordinals_predictions}
first_predictions <- as.data.frame(fitted(first_lagModel))

first_childdata <- filter(functionword_relfreq, word=="first", speaker=="child", age>12)
first_childdata$predictions <- first_predictions[, "Estimate"]
```

```{r first_ordinals_prediction_Plot} 
ggplot(first_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### Fourth (Not enough data)

```{r fourth_ordinals_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="fourth")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker)
```




### Additives

#### Again (Done)

```{r again_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="again") %>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()  +
  labs(title = "Again") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r again_growth_model, include=FALSE}
again_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="again", speaker=="child"),
  prior = c(
    prior(uniform(0, 3), nlpar = "upperAsymptote", lb = 0, ub = 3),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/again_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r again_predictions}
again_predictions <- as.data.frame(fitted(again_lagModel))

again_childdata <- filter(functionword_relfreq, word=="again", speaker=="child")
again_childdata$predictions <- again_predictions[, "Estimate"]
```

```{r again_prediction_Plot} 
again_plot <-
  ggplot(again_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Again", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r again_age_of_production}
age_of_production <-
  rbind(age_of_production, c("again", round(fixef(again_lagModel)[3,],1)))
```

#### Too (Unreliable)

```{r too_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="too") %>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "Too") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r too_growth_model, include=FALSE}
too_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="too", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/too_lagModel",
  control = list(adapt_delta = 0.98),
  iter = 10000)
```

```{r too_predictions}
too_predictions <- as.data.frame(fitted(too_lagModel))

too_childdata <- filter(functionword_relfreq, word=="too", speaker=="child")
too_childdata$predictions <- too_predictions[, "Estimate"]
```

```{r too_prediction_Plot} 
too_plot <-
  ggplot(too_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Too", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r too_age_of_production}
age_of_production <-
  rbind(age_of_production, c("too", round(fixef(too_lagModel)[3,],1)))
```

#### Also (Unreliable)

```{r also_additives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="also")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "Also") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r also_growth_model, include=FALSE}
also_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="also", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/also_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 10000)
```

```{r also_predictions}
also_predictions <- as.data.frame(fitted(also_lagModel))

also_childdata <- filter(functionword_relfreq, word=="also", speaker=="child", age>23)
also_childdata$predictions <- also_predictions[, "Estimate"]
```

```{r also_prediction_Plot} 
also_plot <-
  ggplot(also_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Also", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r also_age_of_production}
age_of_production <-
  rbind(age_of_production, c("also", round(fixef(also_lagModel)[3,],1)))
```

#### Another (Done)

```{r another_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="another")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "Another") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r another_growth_model, include=FALSE}
another_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="another", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/another_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 10000)
```

```{r another_predictions}
another_predictions <- as.data.frame(fitted(another_lagModel))

another_childdata <- filter(functionword_relfreq, word=="another", speaker=="child")
another_childdata$predictions <- another_predictions[, "Estimate"]
```

```{r another_prediction_Plot} 
another_plot <-
  ggplot(another_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Another", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r another_age_of_production}
age_of_production <-
  rbind(age_of_production, c("another", round(fixef(another_lagModel)[3,],1)))
```


#### Still (Unreliable)

```{r still_additives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="still")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "Still") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r still_growth_model, include=FALSE}
still_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="still", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/still_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 10000)
```

```{r still_predictions}
still_predictions <- as.data.frame(fitted(still_lagModel))

still_childdata <- filter(functionword_relfreq, word=="still", speaker=="child")
still_childdata$predictions <- still_predictions[, "Estimate"]
```

```{r still_prediction_Plot} 
still_plot <-
  ggplot(still_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Still", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r still_age_of_production}
age_of_production <-
  rbind(age_of_production, c("still", round(fixef(still_lagModel)[3,],1)))
```

#### Other (Unreliable)

```{r other_additives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="other")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  theme_bw() +
  facet_grid(.~speaker) +
  labs(title = "Other") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r too_growth_model, include=FALSE}
other_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="other", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/other_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 10000)
```

```{r too_predictions}
other_predictions <- as.data.frame(fitted(other_lagModel))

other_childdata <- filter(functionword_relfreq, word=="other", speaker=="child")
other_childdata$predictions <- other_predictions[, "Estimate"]
```

```{r too_prediction_Plot} 
other_plot <-
  ggplot(other_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()+ labs(title="Other", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r too_age_of_production}
age_of_production <-
  rbind(age_of_production, c("other", round(fixef(must_lagModel)[3,],1)))
```

#### Others (Unreliable)

```{r other_additives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="others")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker)
```

```{r another_additives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="another")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker)
```

```{r too_growth_model, include=FALSE}
too_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="too", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/too_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 15000)
```

```{r too_age_of_production}
age_of_production <-
  rbind(age_of_production, c("too", round(fixef(must_lagModel)[3,],1)))
```

```{r too_predictions}
too_predictions <- as.data.frame(fitted(too_lagModel))

too_childdata <- filter(functionword_relfreq, word=="too", speaker=="child")
too_childdata$predictions <- too_predictions[, "Estimate"]
```

```{r too_prediction_Plot} 
ggplot(too_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


### Negative Polarity Items

#### Any (Done)

```{r any_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="any")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Any") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r any_growth_model, include=FALSE}
any_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="any", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/any_lagModel",
  iter = 10000)
```

```{r any_predictions}
any_predictions <- as.data.frame(fitted(any_lagModel))

any_childdata <- filter(functionword_relfreq, word=="any", speaker=="child")
any_childdata$predictions <- any_predictions[, "Estimate"]
```

```{r any_prediction_Plot} 
any_plot <-
  ggplot(any_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Any", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r any_age_of_production}
age_of_production <-
  rbind(age_of_production, c("any", round(fixef(why_lagModel)[3,],1)))
```

#### Yet (Unreliable)

```{r any_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="yet")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Yet") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r yet_growth_model, include=FALSE}
yet_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="yet", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/yet_lagModel",
  iter = 10000)
```

```{r yet_predictions}
yet_predictions <- as.data.frame(fitted(yet_lagModel))

yet_childdata <- filter(functionword_relfreq, word=="yet", speaker=="child")
yet_childdata$predictions <- yet_predictions[, "Estimate"]
```

```{r yet_prediction_Plot} 
yet_plot <-
  ggplot(yet_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Yet", x="Age (Months)", y="Cumulative Relative Frequency (PPT)") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r yet_age_of_production}
age_of_production <-
  rbind(age_of_production, c("yet", round(fixef(yet_lagModel)[3,],1)))
```

#### Ever (Unreliable)

```{r ever_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="ever")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Ever") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r ever_growth_model, include=FALSE}
ever_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="ever", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/ever_lagModel",
  iter = 10000)
```

```{r ever_predictions}
ever_predictions <- as.data.frame(fitted(ever_lagModel))

ever_childdata <- filter(functionword_relfreq, word=="ever", speaker=="child")
ever_childdata$predictions <- ever_predictions[, "Estimate"]
```

```{r ever_prediction_Plot} 
ever_plot <-
ggplot(ever_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Ever", x="Age (Months)", y="Cumulative Relative Frequency (PPT)") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r ever_age_of_production}
age_of_production <-
  rbind(age_of_production, c("ever", round(fixef(ever_lagModel)[3,],1)))
```


#### Anyone (Not Converging)

```{r anyone_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="anyone", age>23)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

```{r anyone_growth_model, include=FALSE}
anyone_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="anyone", speaker=="child", age>23),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/anyone_lagModel",
  control = list(adapt_delta = 0.98),
  iter = 50000)
```

```{r anyone_age_of_production}
age_of_production <-
  rbind(age_of_production, c("anyone", round(fixef(anyone_lagModel)[3,],1)))
```

```{r anyone_predictions}
anyone_predictions <- as.data.frame(fitted(anyone_lagModel))

anyone_childdata <- filter(functionword_relfreq, word=="anyone", speaker=="child", age>23)
anyone_childdata$predictions <- anyone_predictions[, "Estimate"]
```

```{r anyone_prediction_Plot} 
ggplot(anyone_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### Anything

```{r anything_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="anything")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

```{r anything_growth_model, include=FALSE}
anything_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="anything", speaker=="child", age>15),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/anything_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r anything_age_of_production}
age_of_production <-
  rbind(age_of_production, c("anything", round(fixef(anything_lagModel)[3,],1)))
```

```{r anything_predictions}
anything_predictions <- as.data.frame(fitted(anything_lagModel))

anything_childdata <- filter(functionword_relfreq, word=="anything", speaker=="child", age>15)
anything_childdata$predictions <- anything_predictions[, "Estimate"]
```

```{r anything_prediction_Plot} 
ggplot(anything_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

#### Anywhere

```{r anywhere_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="anywhere")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

```{r anywhere_growth_model, include=FALSE}
anywhere_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="anywhere", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/anywhere_lagModel",
  iter = 10000)
```

```{r anywhere_age_of_production}
age_of_production <-
  rbind(age_of_production, c("anywhere", round(fixef(anywhere_lagModel)[3,],1)))
```

```{r anywhere_predictions}
anywhere_predictions <- as.data.frame(fitted(anywhere_lagModel))

anywhere_childdata <- filter(functionword_relfreq, word=="anywhere", speaker=="child")
anywhere_childdata$predictions <- anywhere_predictions[, "Estimate"]
```

```{r anywhere_prediction_Plot} 
ggplot(anywhere_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```



#### Anyway

```{r anyway_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="anyway", age>15)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

```{r anyway_growth_model, include=FALSE}
anyway_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="anyway", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/anyway_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 50000)
```

```{r anyway_age_of_production}
age_of_production <-
  rbind(age_of_production, c("anyway", round(fixef(anyway_lagModel)[3,],1)))
```

```{r anyway_predictions}
anyway_predictions <- as.data.frame(fitted(anyway_lagModel))

anyway_childdata <- filter(functionword_relfreq, word=="anyway", speaker=="child")
anyway_childdata$predictions <- anyway_predictions[, "Estimate"]
```

```{r anyway_prediction_Plot} 
ggplot(anyway_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

### Exclusives

#### Only

```{r any_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="only")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Only") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r only_growth_model, include=FALSE}
only_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="only", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/only_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 30000)
```

```{r only_age_of_production}
age_of_production <-
  rbind(age_of_production, c("only", round(fixef(only_lagModel)[3,],1)))
```

```{r only_predictions}
only_predictions <- as.data.frame(fitted(only_lagModel))

only_childdata <- filter(functionword_relfreq, word=="only", speaker=="child")
only_childdata$predictions <- only_predictions[, "Estimate"]
```

```{r only_prediction_Plot} 
ggplot(only_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Only", x="Age (Months)", y="Cumulative Relative Frequency (PPT)") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

#### Just (Done)

```{r any_comparison_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="just")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Just") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r just_growth_model, include=FALSE}
just_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="just", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/just_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 10000)
```

```{r only_predictions}
just_predictions <- as.data.frame(fitted(just_lagModel))

just_childdata <- filter(functionword_relfreq, word=="just", speaker=="child")
just_childdata$predictions <- just_predictions[, "Estimate"]
```

```{r only_prediction_Plot} 
just_plot <-
  ggplot(just_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Just", x="Age (Months)", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r only_age_of_production}
age_of_production <-
  rbind(age_of_production, c("just", round(fixef(just_lagModel)[3,],1)))
```

### Locatives

#### Here (Done)

```{r here_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="here")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Here") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r here_growth_model, include=FALSE}
here_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="here", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/here_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 10000)
```

```{r only_predictions}
here_predictions <- as.data.frame(fitted(here_lagModel))

here_childdata <- filter(functionword_relfreq, word=="here", speaker=="child")
here_childdata$predictions <- here_predictions[, "Estimate"]
```

```{r only_prediction_Plot} 
here_plot <-
  ggplot(here_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Here", x="Age (Months)", y="Cumulative Relative Frequency (PPT)") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r only_age_of_production}
age_of_production <-
  rbind(age_of_production, c("here", round(fixef(here_lagModel)[3,],1)))
```



#### There (Done)

```{r here_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="there")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "There") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r here_growth_model, include=FALSE}
there_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="there", speaker=="child"),
  prior = c(
    prior(uniform(0, 30), nlpar = "upperAsymptote", lb = 0, ub = 30),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/there_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 10000)
```

```{r only_predictions}
there_predictions <- as.data.frame(fitted(there_lagModel))

there_childdata <- filter(functionword_relfreq, word=="there", speaker=="child")
there_childdata$predictions <- there_predictions[, "Estimate"]
```

```{r only_prediction_Plot} 
there_plot <-
  ggplot(there_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="There", x="Age (Months)", y="Cumulative Relative Frequency (PPT)") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r only_age_of_production}
age_of_production <-
  rbind(age_of_production, c("there", round(fixef(there_lagModel)[3,],1)))
```



#### Up (Done)

```{r up_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="up")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Up") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r up_locatives_growth_model, include=FALSE}
up_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="up", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/up_lagModel",
  iter = 10000)
```

```{r up_predictions}
up_predictions <- as.data.frame(fitted(up_lagModel))

up_childdata <- filter(functionword_relfreq, word=="up", speaker=="child")
up_childdata$predictions <- up_predictions[, "Estimate"]
```

```{r up_prediction_Plot} 
up_plot <-
  ggplot(up_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Up", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r up_age_of_production}
age_of_production <-
  rbind(age_of_production, c("up", round(fixef(up_lagModel)[3,],1)))
```

#### On (Done)

```{r on_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="on")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "On") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r on_locatives_growth_model, include=FALSE}
on_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="on", speaker=="child"),
  prior = c(
    prior(uniform(0, 20), nlpar = "upperAsymptote", lb = 0, ub = 20),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/on_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r on_predictions}
on_predictions <- as.data.frame(fitted(on_lagModel))

on_childdata <- filter(functionword_relfreq, word=="on", speaker=="child")
on_childdata$predictions <- on_predictions[, "Estimate"]
```

```{r on_prediction_Plot} 
on_plot <-
  ggplot(on_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="On", x="Age (Months)", y="Cumulative Relative Frequency (PPT)") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r on_age_of_production}
age_of_production <-
  rbind(age_of_production, c("on", round(fixef(on_lagModel)[3,],1)))
```

#### In (Done)

```{r in_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="in")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "In") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```


```{r in_locatives_growth_model, include=FALSE}
in_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="in", speaker=="child"),
  prior = c(
    prior(uniform(0, 20), nlpar = "upperAsymptote", lb = 0, ub = 20),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/in_lagModel",
  iter = 10000)
```

```{r in_predictions}
in_predictions <- as.data.frame(fitted(in_lagModel))

in_childdata <- filter(functionword_relfreq, word=="in", speaker=="child")
in_childdata$predictions <- in_predictions[, "Estimate"]
```

```{r in_prediction_Plot} 
in_plot <-
  ggplot(in_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="In", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r in_age_of_production}
age_of_production <-
  rbind(age_of_production, c("in", round(fixef(in_lagModel)[3,],1)))
```

#### Out (Done)

```{r out_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="out")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Out") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r out_locatives_growth_model, include=FALSE}
out_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="out", speaker=="child"),
  prior = c(
    prior(uniform(0, 6), nlpar = "upperAsymptote", lb = 0, ub = 6),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/out_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r out_predictions}
out_predictions <- as.data.frame(fitted(out_lagModel))

out_childdata <- filter(functionword_relfreq, word=="out", speaker=="child")
out_childdata$predictions <- out_predictions[, "Estimate"]
```

```{r on_prediction_Plot} 
Out_plot <-
  ggplot(out_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Out", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r out_age_of_production}
age_of_production <-
  rbind(age_of_production, c("out", round(fixef(on_lagModel)[3,],1)))
```

#### Outside (No Fit)

```{r outside_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="outside")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

#### Inside (No Fit)

```{r inside_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="inside")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```


#### Down (Done)

```{r down_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="down")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Down") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r down_locatives_growth_model, include=FALSE}
down_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="down", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/down_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r down_predictions}
down_predictions <- as.data.frame(fitted(down_lagModel))

down_childdata <- filter(functionword_relfreq, word=="down", speaker=="child")
down_childdata$predictions <- down_predictions[, "Estimate"]
```

```{r down_prediction_Plot} 
down_plot <-
  ggplot(down_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Down", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r down_age_of_production}
age_of_production <-
  rbind(age_of_production, c("down", round(fixef(down_lagModel)[3,],1)))
```

#### Into

```{r outside_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="into")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Into") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r into_locatives_growth_model, include=FALSE}
into_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="into", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/into_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r into_predictions}
into_predictions <- as.data.frame(fitted(into_lagModel))

into_childdata <- filter(functionword_relfreq, word=="into", speaker=="child")
into_childdata$predictions <- into_predictions[, "Estimate"]
```

```{r into_prediction_Plot} 
into_plot <-
  ggplot(into_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Into", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r into_age_of_production}
age_of_production <-
  rbind(age_of_production, c("into", round(fixef(into_lagModel)[3,],1)))
```


#### Under

```{r outside_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="under")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Under") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r under_locatives_growth_model, include=FALSE}
under_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="under", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/under_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r under_predictions}
under_predictions <- as.data.frame(fitted(under_lagModel))

under_childdata <- filter(functionword_relfreq, word=="under", speaker=="child")
under_childdata$predictions <- under_predictions[, "Estimate"]
```

```{r under_prediction_Plot} 
under_plot <-
  ggplot(under_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Under", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r under_age_of_production}
age_of_production <-
  rbind(age_of_production, c("under", round(fixef(under_lagModel)[3,],1)))
```

#### Above (Not Enough Data)

```{r outside_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="above")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

#### Below (Not Enough Data)

```{r outside_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="below")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```




#### Over (Done)

```{r over_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="over", age>12)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Over") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r over_locatives_growth_model, include=FALSE}
over_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="over", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/over_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r over_predictions}
over_predictions <- as.data.frame(fitted(over_lagModel))

over_childdata <- filter(functionword_relfreq, word=="over", speaker=="child")
over_childdata$predictions <- over_predictions[, "Estimate"]
```

```{r over_prediction_Plot} 
over_plot <-
  ggplot(over_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Over", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r over_age_of_production}
age_of_production <-
  rbind(age_of_production, c("over", round(fixef(over_lagModel)[3,],1)))
```


#### Behind (Not Reliable)

```{r behind_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="behind")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Behind") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r behind_locatives_growth_model, include=FALSE}
behind_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="behind", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/behind_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```


```{r behind_predictions}
behind_predictions <- as.data.frame(fitted(behind_lagModel))

behind_childdata <- filter(functionword_relfreq, word=="behind", speaker=="child")
behind_childdata$predictions <- behind_predictions[, "Estimate"]
```

```{r behind_prediction_Plot} 
behind_plot <-
  ggplot(behind_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Behind", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r behind_age_of_production}
age_of_production <-
  rbind(age_of_production, c("behind", round(fixef(behind_lagModel)[3,],1)))
```


#### Beside (Not Enough Data)

```{r beside_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="beside")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```


#### Between (Not Enough Data)

```{r between_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="between")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```


#### Beyond (not enough data)

```{r beyond_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="beyond")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```


#### Near (Not Converging)

```{r near_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="near")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

```{r near_locatives_growth_model, include=FALSE}
near_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="near", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/near_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 12000)
```

```{r near_age_of_production}
age_of_production <-
  rbind(age_of_production, c("near", round(fixef(near_lagModel)[3,],1)))
```

```{r near_predictions}
near_predictions <- as.data.frame(fitted(near_lagModel))

near_childdata <- filter(functionword_relfreq, word=="near", speaker=="child")
near_childdata$predictions <- near_predictions[, "Estimate"]
```

```{r near_prediction_Plot} 
ggplot(near_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### Onto 

```{r onto_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="onto", age>22)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Onto") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r onto_locatives_growth_model, include=FALSE}
onto_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="onto", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/onto_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```


```{r onto_predictions}
onto_predictions <- as.data.frame(fitted(onto_lagModel))

onto_childdata <- filter(functionword_relfreq, word=="onto", speaker=="child")
onto_childdata$predictions <- near_predictions[, "Estimate"]
```

```{r onto_prediction_Plot} 
ggplot(onto_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

```{r onto_age_of_production}
age_of_production <-
  rbind(age_of_production, c("onto", round(fixef(onto_lagModel)[3,],1)))
```


#### Toward (not enough data)

```{r toward_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="toward")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

#### Along

```{r along_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="along")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

```{r near_locatives_growth_model, include=FALSE}
near_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="near", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/near_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 12000)
```

```{r near_age_of_production}
age_of_production <-
  rbind(age_of_production, c("near", round(fixef(near_lagModel)[3,],1)))
```

```{r near_predictions}
near_predictions <- as.data.frame(fitted(near_lagModel))

near_childdata <- filter(functionword_relfreq, word=="near", speaker=="child")
near_childdata$predictions <- near_predictions[, "Estimate"]
```

```{r near_prediction_Plot} 
ggplot(near_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### Across

```{r across_locatives_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="across")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw()
```

```{r near_locatives_growth_model, include=FALSE}
near_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="near", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/near_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 12000)
```

```{r near_age_of_production}
age_of_production <-
  rbind(age_of_production, c("near", round(fixef(near_lagModel)[3,],1)))
```

```{r near_predictions}
near_predictions <- as.data.frame(fitted(near_lagModel))

near_childdata <- filter(functionword_relfreq, word=="near", speaker=="child")
near_childdata$predictions <- near_predictions[, "Estimate"]
```

```{r near_prediction_Plot} 
ggplot(near_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```

### Other
#### So (NA)

```{r usually_temporalQuant_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="so")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker)
```


#### Either

```{r either_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="either")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "Either") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r either_growth_model, include=FALSE}
either_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="either", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/either_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r either_predictions}
either_predictions <- as.data.frame(fitted(either_lagModel))

either_childdata <- filter(functionword_relfreq, word=="either", speaker=="child")
either_childdata$predictions <- either_predictions[, "Estimate"]
```

```{r either_prediction_Plot} 
either_plot <-  
  ggplot(either_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Either", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("either", round(fixef(either_lagModel)[3,],1)))
```


#### Neither (Not enough data)

```{r neither_other_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="neither")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker)
```


#### Else (Not Converging)

```{r else_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="else")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()
```

```{r else_growth_model, include=FALSE}
else_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="else", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/else_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 12000)
```

```{r else_production}
age_of_production <-
  rbind(age_of_production, c("else", round(fixef(else_lagModel)[3,],1)))
```

```{r else_predictions}
else_predictions <- as.data.frame(fitted(else_lagModel))

else_childdata <- filter(functionword_relfreq, word=="else", speaker=="child")
else_childdata$predictions <- else_predictions[, "Estimate"]
```

```{r else_prediction_Plot} 
ggplot(else_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### Almost

```{r almost_other_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="almost")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()  +
  labs(title = "Almost") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r almost_growth_model, include=FALSE}
almost_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="almost", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/almost_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r almost_predictions}
almost_predictions <- as.data.frame(fitted(almost_lagModel))

almost_childdata <- filter(functionword_relfreq, word=="almost", speaker=="child")
almost_childdata$predictions <- almost_predictions[, "Estimate"]
```

```{r almost_prediction_Plot} 
almost_plot <-
  ggplot(almost_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Almost", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r almost_production}
age_of_production <-
  rbind(age_of_production, c("almost", round(fixef(almost_lagModel)[3,],1)))
```


#### Already

```{r already_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="already")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()  +
  labs(title = "Already") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```
```{r already_growth_model, include=FALSE}
already_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="already", speaker=="child", age>21),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/already_lagModel",
  control = list(adapt_delta = 0.95),
  iter = 20000)
```

```{r already_production}
age_of_production <-
  rbind(age_of_production, c("already", round(fixef(already_lagModel)[3,],1)))
```

```{r already_predictions}
already_predictions <- as.data.frame(fitted(already_lagModel))

already_childdata <- filter(functionword_relfreq, word=="already", speaker=="child", age>20)
already_childdata$predictions <- already_predictions[, "Estimate"]
```

```{r already_prediction_Plot} 
ggplot(already_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### Except (Done)

```{r except_other_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="except")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw()  +
  labs(title = "Except") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r except_growth_model, include=FALSE}
except_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="except", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/except_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r except_predictions}
except_predictions <- as.data.frame(fitted(except_lagModel))

except_childdata <- filter(functionword_relfreq, word=="except", speaker=="child")
except_childdata$predictions <- except_predictions[, "Estimate"]
```

```{r except_prediction_Plot} 
except_plot <-
  ggplot(except_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Except", x="Age (Months)", y="Cumulative Relative Frequency (PPT)") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r except_production}
age_of_production <-
  rbind(age_of_production, c("except", round(fixef(except_lagModel)[3,],1)))
```


#### For (Done)

```{r for_other_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="for")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "For") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r for_growth_model, include=FALSE}
for_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="for", speaker=="child"),
  prior = c(
    prior(uniform(0, 6), nlpar = "upperAsymptote", lb = 0, ub = 6),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/for_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r for_predictions}
for_predictions <- as.data.frame(fitted(for_lagModel))

for_childdata <- filter(functionword_relfreq, word=="for", speaker=="child")
for_childdata$predictions <- for_predictions[, "Estimate"]
```

```{r for_prediction_Plot} 
for_plot <-
  ggplot(for_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="For", x="Age (Months)", y="Cumulative Relative Frequency (PPT)") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r for_production}
age_of_production <-
  rbind(age_of_production, c("for", round(fixef(for_lagModel)[3,],1)))
```

#### From (Done)

```{r from_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="from")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "From") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r from_growth_model, include=FALSE}
from_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="from", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/from_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r from_predictions}
from_predictions <- as.data.frame(fitted(from_lagModel))

from_childdata <- filter(functionword_relfreq, word=="from", speaker=="child")
from_childdata$predictions <- from_predictions[, "Estimate"]
```

```{r from_prediction_Plot} 
from_plot <-
  ggplot(from_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="From", x="Age (Months)", y="Cumulative Relative Frequency (PPT)") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r from_production}
age_of_production <-
  rbind(age_of_production, c("from", round(fixef(from_lagModel)[3,],1)))
```

#### To (Done)

```{r to_other_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="to")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "To") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```


```{r to_growth_model, include=FALSE}
to_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="to", speaker=="child"),
  prior = c(
    prior(uniform(0, 20), nlpar = "upperAsymptote", lb = 0, ub = 20),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/to_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r to_predictions}
to_predictions <- as.data.frame(fitted(to_lagModel))

to_childdata <- filter(functionword_relfreq, word=="to", speaker=="child")
to_childdata$predictions <- to_predictions[, "Estimate"]
```

```{r to_prediction_Plot} 
to_plot <-
  ggplot(to_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="To", x="Age (Months)", y="Cumulative Relative Frequency (PPT)") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r to_production}
age_of_production <-
  rbind(age_of_production, c("to", round(fixef(to_lagModel)[3,],1)))
```

#### By

```{r by_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="by")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "By") + 
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r by_growth_model, include=FALSE}
by_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="by", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/by_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```


```{r by_predictions}
by_predictions <- as.data.frame(fitted(by_lagModel))

by_childdata <- filter(functionword_relfreq, word=="by", speaker=="child")
by_childdata$predictions <- by_predictions[, "Estimate"]
```

```{r by_prediction_Plot} 
by_plot <-
  ggplot(by_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="By", x="Age (Months)", y="Cumulative Relative Frequency (PPT)") + 
  theme(legend.position = "none") + scale_x_continuous(breaks = seq(0, 72, by = 3)) +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  ) 
```

```{r by_production}
age_of_production <-
  rbind(age_of_production, c("by", round(fixef(by_lagModel)[3,],1)))
```


#### Very (Done)

```{r Very_other_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="very")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "Very") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r very_growth_model, include=FALSE}
very_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="very", speaker=="child"),
  prior = c(
    prior(uniform(0, 2), nlpar = "upperAsymptote", lb = 0, ub = 2),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/very_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r very_predictions}
very_predictions <- as.data.frame(fitted(very_lagModel))

very_childdata <- filter(functionword_relfreq, word=="very", speaker=="child")
very_childdata$predictions <- very_predictions[, "Estimate"]
```

```{r very_prediction_Plot} 
very_plot <-
  ggplot(very_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Very", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("very", round(fixef(very_lagModel)[3,],1)))
```

#### With (Done)

```{r with_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="with")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "With") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r with_growth_model, include=FALSE}
with_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="with", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/with_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r with_predictions}
with_predictions <- as.data.frame(fitted(with_lagModel))

with_childdata <- filter(functionword_relfreq, word=="with", speaker=="child")
with_childdata$predictions <- with_predictions[, "Estimate"]
```

```{r with_prediction_Plot} 
with_plot <-
  ggplot(with_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="With", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r with_production}
age_of_production <-
  rbind(age_of_production, c("with", round(fixef(with_lagModel)[3,],1)))
```

#### Without

```{r without_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="without")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "Without") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r without_growth_model, include=FALSE}
without_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="without", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/without_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r without_predictions}
without_predictions <- as.data.frame(fitted(without_lagModel))

without_childdata <- filter(functionword_relfreq, word=="without", speaker=="child", age>25)
without_childdata$predictions <- without_predictions[, "Estimate"]
```

```{r without_prediction_Plot} 
without_plot <-
  ggplot(without_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Without", x="", y="") + 
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r without_production}
age_of_production <-
  rbind(age_of_production, c("without", round(fixef(either_lagModel)[3,],1)))
```

#### Instead

```{r instead_other_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="instead", age>23)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "Instead") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r instead_growth_model, include=FALSE}
instead_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="instead", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/instead_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r instead_predictions}
instead_predictions <- as.data.frame(fitted(instead_lagModel))

instead_childdata <- filter(functionword_relfreq, word=="instead", speaker=="child")
instead_childdata$predictions <- instead_predictions[, "Estimate"]
```

```{r instead_prediction_Plot} 
instead_plot <-  
  ggplot(instead_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Instead", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r instead_production}
age_of_production <-
  rbind(age_of_production, c("instead", round(fixef(instead_lagModel)[3,],1)))
```


#### Such

```{r such_other_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="such", speaker=="child")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "Such") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```


```{r such_growth_model, include=FALSE}
such_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="such", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 5), nlpar = "growthRate", lb = 0, ub = 5),
    prior(uniform(12, 72), nlpar = "lag", lb = 12, ub = 72)
  ),
  file = "../modeling/such_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 12000)
```

```{r such_production}
age_of_production <-
  rbind(age_of_production, c("such", round(fixef(such_lagModel)[3,],1)))
```

```{r such_predictions}
such_predictions <- as.data.frame(fitted(such_lagModel))

such_childdata <- filter(functionword_relfreq, word=="such", speaker=="child")
such_childdata$predictions <- such_predictions[, "Estimate"]
```

```{r either_prediction_Plot} 
ggplot(such_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw()
```


#### About (Done)

```{r about_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="about")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + theme_bw() +
  labs(title = "About") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r about_growth_model, include=FALSE}
about_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="about", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/about_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r about_predictions}
about_predictions <- as.data.frame(fitted(about_lagModel))

about_childdata <- filter(functionword_relfreq, word=="about", speaker=="child")
about_childdata$predictions <- about_predictions[, "Estimate"]
```

```{r either_prediction_Plot} 
about_plot <-
  ggplot(about_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="About", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("about", round(fixef(about_lagModel)[3,],1)))
```

#### Whether (Not enough data)

```{r whether_other_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="whether")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker)
```



### Pronouns

#### Mine

```{r mine_pronoun_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="mine")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Mine") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r mine_growth_model, include=FALSE}
mine_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="mine", speaker=="child"),
  prior = c(
    prior(uniform(0, 5), nlpar = "upperAsymptote", lb = 0, ub = 5),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/mine_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r mine_predictions}
mine_predictions <- as.data.frame(fitted(mine_lagModel))

mine_childdata <- filter(functionword_relfreq, word=="mine", speaker=="child")
mine_childdata$predictions <- about_predictions[, "Estimate"]
```

```{r either_prediction_Plot} 
mine_plot <-
  ggplot(mine_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Mine", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("mine", round(fixef(mine_lagModel)[3,],1)))
```


#### Me (Done)

```{r me_pronoun_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="me", age>12)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Me") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand") 
```

```{r mine_growth_model, include=FALSE}
me_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="me", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/me_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r mine_predictions}
me_predictions <- as.data.frame(fitted(me_lagModel))

me_childdata <- filter(functionword_relfreq, word=="me", speaker=="child")
me_childdata$predictions <- me_predictions[, "Estimate"]
```

```{r either_prediction_Plot} 
me_plot <-
  ggplot(me_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Me", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("me", round(fixef(me_lagModel)[3,],1)))
```


#### I (Done)

```{r i_pronoun_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="i")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "I") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r mine_growth_model, include=FALSE}
I_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="i", speaker=="child"),
  prior = c(
    prior(uniform(0, 50), nlpar = "upperAsymptote", lb = 0, ub = 50),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/I_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r mine_predictions}
I_predictions <- as.data.frame(fitted(I_lagModel))

I_childdata <- filter(functionword_relfreq, word=="i", speaker=="child")
I_childdata$predictions <- I_predictions[, "Estimate"]
```

```{r either_prediction_Plot} 
I_plot <-
  ggplot(I_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="I", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("I", round(fixef(I_lagModel)[3,],1)))
```


#### You (Done)

```{r you_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="you")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "You") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r you_growth_model, include=FALSE}
you_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="you", speaker=="child"),
  prior = c(
    prior(uniform(0, 50), nlpar = "upperAsymptote", lb = 0, ub = 50),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/you_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r mine_predictions}
you_predictions <- as.data.frame(fitted(you_lagModel))

you_childdata <- filter(functionword_relfreq, word=="you", speaker=="child")
you_childdata$predictions <- you_predictions[, "Estimate"]
```

```{r either_prediction_Plot} 
you_plot <-
  ggplot(you_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="You", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("you", round(fixef(you_lagModel)[3,],1)))
```

#### Your (Done)

```{r you_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="your")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Your") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r your_growth_model, include=FALSE}
your_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="your", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/your_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r mine_predictions}
your_predictions <- as.data.frame(fitted(your_lagModel))

your_childdata <- filter(functionword_relfreq, word=="your", speaker=="child")
your_childdata$predictions <- your_predictions[, "Estimate"]
```

```{r either_prediction_Plot} 
your_plot <-
  ggplot(your_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Your", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("your", round(fixef(your_lagModel)[3,],1)))
```


#### Yours

```{r you_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="yours")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Yours") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r your_growth_model, include=FALSE}
your_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="your", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/your_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r mine_predictions}
your_predictions <- as.data.frame(fitted(your_lagModel))

your_childdata <- filter(functionword_relfreq, word=="your", speaker=="child")
your_childdata$predictions <- your_predictions[, "Estimate"]
```

```{r either_prediction_Plot} 
your_plot <-
  ggplot(your_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Your", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("your", round(fixef(your_lagModel)[3,],1)))
```


#### We (Done)

```{r you_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="we")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "We") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r we_growth_model, include=FALSE}
we_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="we", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/we_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r we_predictions}
we_predictions <- as.data.frame(fitted(we_lagModel))

we_childdata <- filter(functionword_relfreq, word=="we", speaker=="child")
we_childdata$predictions <- we_predictions[, "Estimate"]
```

```{r we_prediction_Plot} 
we_plot <-
  ggplot(we_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="We", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("we", round(fixef(we_lagModel)[3,],1)))
```

#### Our (Done)

```{r you_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="our")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Our") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r our_growth_model, include=FALSE}
our_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="our", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/our_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r we_predictions}
our_predictions <- as.data.frame(fitted(our_lagModel))

our_childdata <- filter(functionword_relfreq, word=="our", speaker=="child")
our_childdata$predictions <- our_predictions[, "Estimate"]
```

```{r we_prediction_Plot} 
our_plot <-
  ggplot(our_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Our", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("our", round(fixef(our_lagModel)[3,],1)))
```


#### Ours

```{r you_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="ours", age>12)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Ours") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r ours_growth_model, include=FALSE}
ours_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="ours", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/ours_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r we_predictions}
ours_predictions <- as.data.frame(fitted(ours_lagModel))

ours_childdata <- filter(functionword_relfreq, word=="ours", speaker=="child")
ours_childdata$predictions <- ours_predictions[, "Estimate"]
```

```{r we_prediction_Plot} 
ours_plot <-
  ggplot(ours_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Ours", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("ours", round(fixef(ours_lagModel)[3,],1)))
```


#### She

```{r you_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="she")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "She") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r ours_growth_model, include=FALSE}
she_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="she", speaker=="child"),
  prior = c(
    prior(uniform(0, 6), nlpar = "upperAsymptote", lb = 0, ub = 6),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/she_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r we_predictions}
she_predictions <- as.data.frame(fitted(she_lagModel))

she_childdata <- filter(functionword_relfreq, word=="she", speaker=="child")
she_childdata$predictions <- she_predictions[, "Estimate"]
```

```{r we_prediction_Plot} 
she_plot <-
  ggplot(she_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="she", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("she", round(fixef(she_lagModel)[3,],1)))
```


#### Her (Done)

```{r her_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="her")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Her") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r her_growth_model, include=FALSE}
her_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="her", speaker=="child"),
  prior = c(
    prior(uniform(0, 6), nlpar = "upperAsymptote", lb = 0, ub = 6),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/her_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r her_predictions}
her_predictions <- as.data.frame(fitted(her_lagModel))

her_childdata <- filter(functionword_relfreq, word=="her", speaker=="child")
her_childdata$predictions <- her_predictions[, "Estimate"]
```

```{r we_prediction_Plot} 
her_plot <-
  ggplot(her_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Her", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("her", round(fixef(her_lagModel)[3,],1)))
```


#### Hers

```{r you_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="hers", age>12)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Hers") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```


#### He

```{r he_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="he")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "He") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r he_growth_model, include=FALSE}
he_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="he", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/he_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r he_predictions}
he_predictions <- as.data.frame(fitted(he_lagModel))

he_childdata <- filter(functionword_relfreq, word=="he", speaker=="child")
he_childdata$predictions <- he_predictions[, "Estimate"]
```

```{r he_prediction_Plot} 
he_plot <-
  ggplot(he_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="He", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r he_production}
age_of_production <-
  rbind(age_of_production, c("he", round(fixef(he_lagModel)[3,],1)))
```


#### His (Done)

```{r his_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="his", age>12)%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "His") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r his_growth_model, include=FALSE}
his_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="his", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/his_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r he_predictions}
his_predictions <- as.data.frame(fitted(his_lagModel))

his_childdata <- filter(functionword_relfreq, word=="his", speaker=="child")
his_childdata$predictions <- his_predictions[, "Estimate"]
```

```{r we_prediction_Plot} 
his_plot <-
  ggplot(his_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="His", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("his", round(fixef(his_lagModel)[3,],1)))
```


#### They (done)

```{r you_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="they")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "They") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r they_growth_model, include=FALSE}
they_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="they", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/they_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r they_predictions}
they_predictions <- as.data.frame(fitted(they_lagModel))

they_childdata <- filter(functionword_relfreq, word=="they", speaker=="child")
they_childdata$predictions <- they_predictions[, "Estimate"]
```

```{r we_prediction_Plot} 
they_plot <-
  ggplot(they_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="They", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("they", round(fixef(they_lagModel)[3,],1)))
```

#### Their

```{r it_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="their")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Their") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r their_growth_model, include=FALSE}
their_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="their", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/their_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r their_predictions}
their_predictions <- as.data.frame(fitted(their_lagModel))

their_childdata <- filter(functionword_relfreq, word=="their", speaker=="child")
their_childdata$predictions <- their_predictions[, "Estimate"]
```

```{r their_prediction_Plot} 
their_plot <-
  ggplot(their_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Their", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("they", round(fixef(they_lagModel)[3,],1)))
```


#### Theirs

```{r it_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="theirs")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Theirs") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

#### It (Done)

```{r it_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="it")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "It") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand") 
```

```{r their_growth_model, include=FALSE}
it_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="it", speaker=="child"),
  prior = c(
    prior(uniform(0, 50), nlpar = "upperAsymptote", lb = 0, ub = 50),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/it_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r their_predictions}
it_predictions <- as.data.frame(fitted(it_lagModel))

it_childdata <- filter(functionword_relfreq, word=="it", speaker=="child")
it_childdata$predictions <- it_predictions[, "Estimate"]
```

```{r their_prediction_Plot} 
it_plot <-
  ggplot(it_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="It", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("it", round(fixef(it_lagModel)[3,],1)))
```


#### Its

```{r its_pronoun_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="its")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Its") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r its_growth_model, include=FALSE}
its_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="its", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/its_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r its_predictions}
its_predictions <- as.data.frame(fitted(its_lagModel))

its_childdata <- filter(functionword_relfreq, word=="its", speaker=="child")
its_childdata$predictions <- it_predictions[, "Estimate"]
```

```{r its_prediction_Plot} 
its_plot <-
  ggplot(its_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Its", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("its", round(fixef(its_lagModel)[3,],1)))
```


### Auxiliaries

#### 'm

```{r it_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="'m")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "'m") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r their_growth_model, include=FALSE}
m_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="'m", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/m_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r their_predictions}
m_predictions <- as.data.frame(fitted(m_lagModel))

m_childdata <- filter(functionword_relfreq, word=="'m", speaker=="child")
m_childdata$predictions <- m_predictions[, "Estimate"]
```

```{r their_prediction_Plot} 
m_plot <-
  ggplot(m_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="'m", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("'m", round(fixef(m_lagModel)[3,],1)))
```


#### am

```{r it_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="am")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Am") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r their_growth_model, include=FALSE}
am_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="am", speaker=="child"),
  prior = c(
    prior(uniform(0, 1), nlpar = "upperAsymptote", lb = 0, ub = 1),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/am_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r their_predictions}
am_predictions <- as.data.frame(fitted(am_lagModel))

am_childdata <- filter(functionword_relfreq, word=="am", speaker=="child")
am_childdata$predictions <- am_predictions[, "Estimate"]
```

```{r their_prediction_Plot} 
am_plot <-
  ggplot(am_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="am", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("am", round(fixef(am_lagModel)[3,],1)))
```


#### is

```{r it_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="is")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Is") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r their_growth_model, include=FALSE}
is_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="is", speaker=="child"),
  prior = c(
    prior(uniform(0, 50), nlpar = "upperAsymptote", lb = 0, ub = 50),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/is_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r their_predictions}
is_predictions <- as.data.frame(fitted(is_lagModel))

is_childdata <- filter(functionword_relfreq, word=="is", speaker=="child")
is_childdata$predictions <- is_predictions[, "Estimate"]
```

```{r their_prediction_Plot} 
is_plot <-
  ggplot(is_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Is", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("is", round(fixef(is_lagModel)[3,],1)))
```

#### are

```{r it_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="are")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Are") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r their_growth_model, include=FALSE}
are_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="are", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/are_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r their_predictions}
are_predictions <- as.data.frame(fitted(are_lagModel))

are_childdata <- filter(functionword_relfreq, word=="are", speaker=="child")
are_childdata$predictions <- are_predictions[, "Estimate"]
```

```{r their_prediction_Plot} 
are_plot <-
  ggplot(are_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="are", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("are", round(fixef(are_lagModel)[3,],1)))
```


#### was

```{r it_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="was")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Was") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r their_growth_model, include=FALSE}
was_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="was", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/was_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r their_predictions}
was_predictions <- as.data.frame(fitted(was_lagModel))

was_childdata <- filter(functionword_relfreq, word=="was", speaker=="child")
was_childdata$predictions <- was_predictions[, "Estimate"]
```

```{r their_prediction_Plot} 
was_plot <-
  ggplot(was_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Was", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("was", round(fixef(was_lagModel)[3,],1)))
```


#### were

```{r it_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="were")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Were") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r their_growth_model, include=FALSE}
were_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="were", speaker=="child"),
  prior = c(
    prior(uniform(0, 2), nlpar = "upperAsymptote", lb = 0, ub = 2),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/were_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r their_predictions}
were_predictions <- as.data.frame(fitted(were_lagModel))

were_childdata <- filter(functionword_relfreq, word=="were", speaker=="child")
were_childdata$predictions <- were_predictions[, "Estimate"]
```

```{r their_prediction_Plot} 
were_plot <-
  ggplot(were_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Were", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("were", round(fixef(were_lagModel)[3,],1)))
```

#### do (done)

```{r it_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="do")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Do") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r their_growth_model, include=FALSE}
do_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="do", speaker=="child"),
  prior = c(
    prior(uniform(0, 50), nlpar = "upperAsymptote", lb = 0, ub = 50),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/do_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r their_predictions}
do_predictions <- as.data.frame(fitted(do_lagModel))

do_childdata <- filter(functionword_relfreq, word=="do", speaker=="child")
do_childdata$predictions <- do_predictions[, "Estimate"]
```

```{r their_prediction_Plot} 
do_plot <-
  ggplot(do_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Do", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("do", round(fixef(do_lagModel)[3,],1)))
```

#### does (done)

```{r it_pronouns_plot, echo=FALSE}
functionword_relfreq %>%
  filter(word=="does")%>%
  ggplot(aes(age, cumulative_ppt)) +
  geom_point() +
  facet_grid(.~speaker) + 
  theme_bw() +
  labs(title = "Does") +
  xlab("Child Age (Months)") + ylab("Cumulative Parts Per Thousand")
```

```{r their_growth_model, include=FALSE}
does_lagModel <- brm(
  bf(cumulative_ppt  ~ upperAsymptote * exp(-exp(((growthRate*exp(1))/upperAsymptote)*(lag-age)+1)),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     lag ~ 1,
     nl = TRUE),
  data = filter(functionword_relfreq, word=="does", speaker=="child"),
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 10), nlpar = "growthRate", lb = 0, ub = 10),
    prior(uniform(0, 72), nlpar = "lag", lb = 0, ub = 72)
  ),
  file = "../modeling/does_lagModel",
  control = list(adapt_delta = 0.9),
  iter = 10000)
```

```{r their_predictions}
does_predictions <- as.data.frame(fitted(does_lagModel))

does_childdata <- filter(functionword_relfreq, word=="does", speaker=="child")
does_childdata$predictions <- does_predictions[, "Estimate"]
```

```{r their_prediction_Plot} 
does_plot <-
  ggplot(does_childdata, aes(x = age, y = cumulative_ppt)) +
  geom_point(aes(color = "Actual Data"), size = 2) + # Original data points
  geom_line(aes(y = predictions, color = "Fitted Values"), size = 1) + # Fitted values
  scale_color_manual(name = "Legend", values = c("Actual Data" = "black", "Fitted Values" = "blue")) +
  theme_bw() + labs(title="Does", x="", y="") +
  theme(legend.position = "none") +   
  theme(
    plot.title = element_text(size = 20, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    legend.title = element_text(size = 14),
    legend.text  = element_text(size = 12)
  )
```

```{r either_production}
age_of_production <-
  rbind(age_of_production, c("does", round(fixef(does_lagModel)[3,],1)))
```


# Collection of some plots

```{r}
library(gridExtra)
grid.arrange(me_plot, more_plot, what_plot, the_plot, some_plot, and_plot, can_plot, in_plot, layout_matrix = rbind(c(1, 2), c(3, 4), c(5, 6), c(7,8)))

grid.arrange(if_plot, any_plot, can_plot, a_plot, another_plot, nt_plot, up_plot, who_plot, just_plot, all_plot, layout_matrix = rbind(c(1, 2), c(3, 4), c(5, 6), c(7,8), c(9,10)))
```

# Age of Production Plot

```{r}
age_of_production <- 
  age_of_production %>%
  mutate(word = fct_reorder(word, Estimate), 
         Estimate = as.numeric(age_of_production$Estimate),
         Q2.5 = as.numeric(age_of_production$Q2.5),
         Q97.5 = as.numeric(age_of_production$Q97.5))

saveRDS(age_of_production, "../processed_data/age_of_production.RDS")
```

```{r}
#age_of_production <- readRDS("../processed_data/age_of_production.RDS")

functionword_onsetage_plot<-
  age_of_production %>%
  ggplot(aes(x=Estimate, y=word)) +
  geom_pointrange(aes(xmin = Q2.5, xmax = Q97.5)) +
  theme_bw() + 
  theme(axis.text.y = element_text(size = 14), xlab="age") +
  scale_x_continuous(breaks = seq(0, 72, by = 3)) +
  labs(x = "Age (Months)", y="") +
  theme(text = element_text(family = "Times New Roman", size = 14))
```
